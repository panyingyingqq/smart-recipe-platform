import{r as s,j as e}from"./vendor-cpxq64b2.js";import{u as I,s as P}from"./index-3IvfZGzb.js";import{u as Q,p as y}from"./utils-C66LSg7K.js";import{c as D,e as $,d as N,a as U,F as Z}from"./ui-DrWiCD5s.js";const O=()=>{const[o,L]=s.useState([]),[S,g]=s.useState(!0),[w,A]=s.useState(null),[p,F]=s.useState(""),[i,l]=s.useState(""),[c,C]=s.useState(null),[_,d]=s.useState(!1),{openRecipe:z}=I(),[E,k]=s.useState(12),{ref:M,inView:b}=Q({threshold:.1,rootMargin:"100px"}),x="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");s.useEffect(()=>{const t=setTimeout(()=>{F(i)},300);return()=>clearTimeout(t)},[i]),s.useEffect(()=>{b&&k(t=>t+12)},[b]),s.useEffect(()=>{k(12)},[p,c]);const u=s.useMemo(()=>o.map(r=>{var m;const a=y(r.name,{pattern:"first",toneType:"none",type:"array"}),n=(m=a==null?void 0:a[0])==null?void 0:m.charAt(0).toUpperCase(),h=n&&/^[A-Z]$/.test(n)?n:"#",f=y(r.name,{toneType:"none",separator:"",type:"string"});return{...r,groupLetter:h,fullPinyin:f}}).sort((r,a)=>r.groupLetter===a.groupLetter?r.fullPinyin.localeCompare(a.fullPinyin):r.groupLetter==="#"?1:a.groupLetter==="#"?-1:r.groupLetter.localeCompare(a.groupLetter)),[o]),B=s.useMemo(()=>{if(!i.trim())return[];const t=i.toLowerCase(),r=new Set;for(const a of o)if(a.name.toLowerCase().includes(t)&&r.add(a.name),r.size>=8)break;return Array.from(r)},[i,o]);s.useEffect(()=>{T()},[]);const T=async()=>{try{g(!0),A(null);const{data:t,error:r}=await P.from("recipes").select(`
          *,
          ingredients:recipe_ingredients(
            amount, unit, notes, hint, name,
            ingredient:ingredients(name, image_url, category)
          ),
          steps:recipe_steps(*)
        `).eq("is_public",!0).order("name_en",{ascending:!0});if(r)throw r;L(t||[])}catch(t){console.error("Error fetching recipes:",t),A("无法加载食谱数据，请稍后重试")}finally{g(!1)}},j=s.useMemo(()=>u.filter(t=>{var r,a;if(c&&t.groupLetter!==c)return!1;if(p){const n=p.toLowerCase(),h=t.name.toLowerCase().includes(n),f=(r=t.name_en)==null?void 0:r.toLowerCase().includes(n),m=(a=t.ingredients)==null?void 0:a.some(q=>{var R;return(R=q.ingredient)==null?void 0:R.name.toLowerCase().includes(n)});return h||f||m}return!0}),[u,c,p]),V=s.useMemo(()=>{const t=new Set;return u.forEach(r=>{x.includes(r.groupLetter)&&t.add(r.groupLetter)}),t},[u,x]),v=j.slice(0,E);return e.jsxs("div",{"trae-inspector-start-line":"177","trae-inspector-start-column":"4","trae-inspector-end-line":"339","trae-inspector-end-column":"10","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"space-y-8 relative z-10",children:[e.jsxs("section",{"trae-inspector-start-line":"178","trae-inspector-start-column":"6","trae-inspector-end-line":"257","trae-inspector-end-column":"16","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-center py-8",children:[e.jsx("h1",{"trae-inspector-start-line":"179","trae-inspector-start-column":"8","trae-inspector-end-line":"181","trae-inspector-end-column":"13","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E9%A3%9F%E8%B0%B1%E7%9B%AE%E5%BD%95%22%2C%22textStartLine%22%3A%22179%22%2C%22textStartColumn%22%3A%22106%22%2C%22textEndLine%22%3A%22181%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-3xl md:text-5xl font-bold text-kawaii-text-main mb-4 font-cute tracking-wide",children:"食谱目录"}),e.jsx("p",{"trae-inspector-start-line":"182","trae-inspector-start-column":"8","trae-inspector-end-line":"184","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E6%8C%89%E5%AD%97%E6%AF%8D%E7%B4%A2%E5%BC%95%E6%88%96%E5%85%B3%E9%94%AE%E8%AF%8D%E6%90%9C%E7%B4%A2%EF%BC%8C%E6%8E%A2%E7%B4%A2%E6%88%91%E4%BB%AC%E7%9A%84%E7%BE%8E%E9%A3%9F%E5%AE%9D%E5%BA%93%E3%80%82%22%2C%22textStartLine%22%3A%22182%22%2C%22textStartColumn%22%3A%2285%22%2C%22textEndLine%22%3A%22184%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-kawaii-text-sub mb-8 max-w-2xl mx-auto font-cute text-lg",children:"按字母索引或关键词搜索，探索我们的美食宝库。"}),e.jsxs("div",{"trae-inspector-start-line":"187","trae-inspector-start-column":"8","trae-inspector-end-line":"220","trae-inspector-end-column":"14","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"relative max-w-xl mx-auto mb-10 z-20",children:[e.jsx("input",{"trae-inspector-start-line":"188","trae-inspector-start-column":"10","trae-inspector-end-line":"200","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",type:"text",placeholder:"搜索食谱、食材 (如: 宫保鸡丁, 鸡肉)...",value:i,onChange:t=>{l(t.target.value),d(!0),C(null)},onFocus:()=>d(!0),onBlur:()=>setTimeout(()=>d(!1),200),className:"w-full pl-12 pr-4 py-4 rounded-full border-2 border-kawaii-pink-200 focus:border-kawaii-pink-500 focus:ring-4 focus:ring-kawaii-pink-100 outline-none transition-all shadow-soft font-cute text-kawaii-text-main bg-white/90 backdrop-blur-sm"}),e.jsx(D,{className:"absolute left-4 top-4 w-6 h-6 text-kawaii-pink-400"}),_&&B.length>0&&e.jsx("div",{"trae-inspector-start-line":"205","trae-inspector-start-column":"12","trae-inspector-end-line":"218","trae-inspector-end-column":"18","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl shadow-sticker border border-kawaii-pink-100 overflow-hidden z-30",children:B.map((t,r)=>e.jsx("div",{"trae-inspector-start-line":"207","trae-inspector-start-column":"16","trae-inspector-end-line":"216","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",onClick:()=>{l(t),d(!1)},className:"px-4 py-3 hover:bg-kawaii-pink-50 cursor-pointer text-left text-kawaii-text-main font-cute border-b border-gray-50 last:border-0",children:t},r))})]}),e.jsxs("div",{"trae-inspector-start-line":"223","trae-inspector-start-column":"8","trae-inspector-end-line":"256","trae-inspector-end-column":"14","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"flex flex-wrap justify-center gap-3 mb-10 px-2",children:[e.jsx("button",{"trae-inspector-start-line":"224","trae-inspector-start-column":"10","trae-inspector-end-line":"233","trae-inspector-end-column":"19","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E5%85%A8%E9%83%A8%22%2C%22textStartLine%22%3A%22231%22%2C%22textStartColumn%22%3A%2211%22%2C%22textEndLine%22%3A%22233%22%2C%22textEndColumn%22%3A%2210%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",onClick:()=>C(null),className:`px-4 py-2 rounded-xl text-sm font-bold transition-all font-cute shadow-sm ${c===null?"bg-kawaii-pink-500 text-white shadow-sticker transform scale-105 ring-2 ring-white":"bg-white text-kawaii-text-sub hover:bg-kawaii-pink-100 hover:text-kawaii-pink-700"}`,children:"全部"}),x.map(t=>{const r=!V.has(t);return e.jsx("button",{"trae-inspector-start-line":"237","trae-inspector-start-column":"16","trae-inspector-end-line":"253","trae-inspector-end-column":"25","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",disabled:r,onClick:()=>{C(t),l("")},className:`w-10 h-10 rounded-xl text-sm font-bold flex items-center justify-center transition-all font-cute ${c===t?"bg-kawaii-pink-500 text-white shadow-sticker transform scale-110 ring-2 ring-white z-10":r?"bg-gray-50 text-gray-300 cursor-not-allowed":"bg-white text-kawaii-text-sub hover:bg-kawaii-pink-100 hover:text-kawaii-pink-700 shadow-sm"}`,children:t},t)})]})]}),w&&e.jsxs("div",{"trae-inspector-start-line":"261","trae-inspector-start-column":"8","trae-inspector-end-line":"264","trae-inspector-end-column":"14","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"max-w-md mx-auto bg-red-50 text-red-600 p-4 rounded-2xl flex items-center gap-3 mb-8 shadow-sm font-cute border border-red-100",children:[e.jsx($,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("p",{"trae-inspector-start-line":"263","trae-inspector-start-column":"10","trae-inspector-end-line":"263","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",children:w})]}),S?e.jsx("div",{"trae-inspector-start-line":"269","trae-inspector-start-column":"8","trae-inspector-end-line":"271","trae-inspector-end-column":"14","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"flex justify-center py-20",children:e.jsx(N,{className:"w-12 h-12 text-kawaii-pink-500 animate-spin"})}):e.jsx("div",{"trae-inspector-start-line":"273","trae-inspector-start-column":"8","trae-inspector-end-line":"337","trae-inspector-end-column":"14","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 px-4 pb-12",children:v.length>0?e.jsxs(e.Fragment,{children:[v.map(t=>e.jsxs("div",{"trae-inspector-start-line":"277","trae-inspector-start-column":"16","trae-inspector-end-line":"313","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",onClick:()=>z(t),className:"bg-white rounded-3xl shadow-soft overflow-hidden hover:shadow-sticker transition-all cursor-pointer group border-4 border-white hover:border-kawaii-pink-100 hover:-translate-y-1 content-visibility-auto contain-intrinsic-size-[400px]",children:[e.jsxs("div",{"trae-inspector-start-line":"282","trae-inspector-start-column":"18","trae-inspector-end-line":"297","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"h-52 overflow-hidden relative",children:[e.jsx("img",{"trae-inspector-start-line":"283","trae-inspector-start-column":"20","trae-inspector-end-line":"291","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",src:t.cover_image||"https://images.unsplash.com/photo-1495521841625-f342588d6e65?auto=format&fit=crop&w=800&q=80",alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700",loading:"lazy",decoding:"async",width:"400",height:"208"}),e.jsx("div",{"trae-inspector-start-line":"292","trae-inspector-start-column":"20","trae-inspector-end-line":"296","trae-inspector-end-column":"26","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/50 to-transparent p-4 pt-12",children:e.jsx("h3",{"trae-inspector-start-line":"293","trae-inspector-start-column":"22","trae-inspector-end-line":"295","trae-inspector-end-column":"27","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"font-bold text-xl text-white mb-1 font-cute drop-shadow-md",children:t.name})})]}),e.jsxs("div",{"trae-inspector-start-line":"298","trae-inspector-start-column":"18","trae-inspector-end-line":"312","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"p-5",children:[e.jsxs("div",{"trae-inspector-start-line":"299","trae-inspector-start-column":"20","trae-inspector-end-line":"308","trae-inspector-end-column":"26","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"flex items-center gap-4 text-sm text-kawaii-text-sub mb-3 font-cute",children:[e.jsxs("div",{"trae-inspector-start-line":"300","trae-inspector-start-column":"22","trae-inspector-end-line":"303","trae-inspector-end-column":"28","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4 text-kawaii-pink-400"}),e.jsxs("span",{"trae-inspector-start-line":"302","trae-inspector-start-column":"24","trae-inspector-end-line":"302","trae-inspector-end-column":"57","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",children:[t.total_time,"分"]})]}),e.jsxs("div",{"trae-inspector-start-line":"304","trae-inspector-start-column":"22","trae-inspector-end-line":"307","trae-inspector-end-column":"28","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4 text-kawaii-pink-400"}),e.jsxs("span",{"trae-inspector-start-line":"306","trae-inspector-start-column":"24","trae-inspector-end-line":"306","trae-inspector-end-column":"59","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",children:["难度 ",t.difficulty]})]})]}),e.jsx("p",{"trae-inspector-start-line":"309","trae-inspector-start-column":"20","trae-inspector-end-line":"311","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-kawaii-text-sub text-sm line-clamp-2 font-cute leading-relaxed",children:t.description})]})]},t.id)),E<j.length&&e.jsx("div",{"trae-inspector-start-line":"318","trae-inspector-start-column":"16","trae-inspector-end-line":"320","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",ref:M,className:"col-span-full flex justify-center py-8",children:e.jsx(N,{className:"w-8 h-8 animate-spin text-kawaii-pink-300"})})]}):e.jsxs("div",{"trae-inspector-start-line":"324","trae-inspector-start-column":"12","trae-inspector-end-line":"335","trae-inspector-end-column":"18","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"col-span-full text-center py-10 text-kawaii-text-sub flex flex-col items-center gap-4 font-cute",children:[e.jsx("div",{"trae-inspector-start-line":"325","trae-inspector-start-column":"14","trae-inspector-end-line":"327","trae-inspector-end-column":"20","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"w-20 h-20 bg-kawaii-pink-50 rounded-full flex items-center justify-center",children:e.jsx(D,{className:"w-10 h-10 text-kawaii-pink-200"})}),e.jsx("p",{"trae-inspector-start-line":"328","trae-inspector-start-column":"14","trae-inspector-end-line":"328","trae-inspector-end-column":"50","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E6%B2%A1%E6%9C%89%E6%89%BE%E5%88%B0%E5%8C%B9%E9%85%8D%E7%9A%84%E9%A3%9F%E8%B0%B1%22%2C%22textStartLine%22%3A%22328%22%2C%22textStartColumn%22%3A%2237%22%2C%22textEndLine%22%3A%22328%22%2C%22textEndColumn%22%3A%2246%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-lg",children:"没有找到匹配的食谱"}),e.jsx("button",{"trae-inspector-start-line":"329","trae-inspector-start-column":"14","trae-inspector-end-line":"334","trae-inspector-end-column":"23","trae-inspector-file-path":"src\\\\pages\\\\Recipes.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E6%B8%85%E9%99%A4%E6%90%9C%E7%B4%A2%22%2C%22textStartLine%22%3A%22332%22%2C%22textStartColumn%22%3A%2215%22%2C%22textEndLine%22%3A%22334%22%2C%22textEndColumn%22%3A%2214%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",onClick:()=>l(""),className:"text-kawaii-pink-500 text-sm hover:underline hover:text-kawaii-pink-700",children:"清除搜索"})]})})]})};export{O as default};
