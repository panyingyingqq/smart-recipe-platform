import{r as d,R as A,j as t,m as f}from"./vendor-cpxq64b2.js";import{u as h,s as n}from"./index-3IvfZGzb.js";import{D as B}from"./ui-DrWiCD5s.js";import"./utils-C66LSg7K.js";const y=()=>{const[r,i]=d.useState(!1),[m,o]=d.useState([]),{openRecipe:x}=h();A.useEffect(()=>{(async()=>{const{data:a}=await n.from("recipes").select("id").eq("is_public",!0);a&&o(a.map(s=>s.id))})()},[]);const E=async()=>{i(!0);try{let e=m;if(e.length===0){const{data:p,error:l}=await n.from("recipes").select("id").eq("is_public",!0);if(l)throw l;p&&(e=p.map(C=>C.id),o(e))}if(e.length===0){alert("暂无食谱数据");return}const a=Math.floor(Math.random()*e.length),s=e[a],{data:u,error:c}=await n.from("recipes").select(`
          *,
          ingredients:recipe_ingredients(
            amount, unit, notes, name, hint,
            ingredient:ingredients(name, image_url, category)
          ),
          steps:recipe_steps(*)
        `).eq("id",s).single();if(c)throw c;x(u)}catch(e){console.error("Error fetching random recipe:",e),alert("获取食谱失败，请稍后重试")}finally{i(!1)}};return t.jsx("div",{"trae-inspector-start-line":"78","trae-inspector-start-column":"4","trae-inspector-end-line":"100","trae-inspector-end-column":"10","trae-inspector-file-path":"src\\\\pages\\\\Home.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"space-y-8",children:t.jsxs("section",{"trae-inspector-start-line":"79","trae-inspector-start-column":"6","trae-inspector-end-line":"99","trae-inspector-end-column":"16","trae-inspector-file-path":"src\\\\pages\\\\Home.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-center py-12 md:py-20 relative z-10",children:[t.jsx("h1",{"trae-inspector-start-line":"80","trae-inspector-start-column":"8","trae-inspector-end-line":"82","trae-inspector-end-column":"13","trae-inspector-file-path":"src\\\\pages\\\\Home.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E4%BB%8A%E5%A4%A9%E5%90%83%E4%BB%80%E4%B9%88%EF%BC%9F%22%2C%22textStartLine%22%3A%2280%22%2C%22textStartColumn%22%3A%22121%22%2C%22textEndLine%22%3A%2282%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-4xl md:text-6xl font-bold text-kawaii-text-main mb-6 font-cute drop-shadow-sm tracking-wide",children:"今天吃什么？"}),t.jsx("p",{"trae-inspector-start-line":"83","trae-inspector-start-column":"8","trae-inspector-end-line":"85","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\pages\\\\Home.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E4%B8%8D%E7%9F%A5%E9%81%93%E5%81%9A%E4%BB%80%E4%B9%88%E8%8F%9C%EF%BC%9F%E8%AE%A9%E6%88%91%E4%BB%AC%E7%9A%84%E6%99%BA%E8%83%BD%E9%A3%9F%E8%B0%B1%E5%86%B3%E7%AD%96%E5%99%A8%E5%B8%AE%E4%BD%A0%E5%86%B3%E5%AE%9A%EF%BC%81%22%2C%22textStartLine%22%3A%2283%22%2C%22textStartColumn%22%3A%2286%22%2C%22textEndLine%22%3A%2285%22%2C%22textEndColumn%22%3A%228%22%2C%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",className:"text-xl text-kawaii-text-sub mb-10 max-w-2xl mx-auto font-cute",children:"不知道做什么菜？让我们的智能食谱决策器帮你决定！"}),t.jsxs("button",{"trae-inspector-start-line":"86","trae-inspector-start-column":"8","trae-inspector-end-line":"98","trae-inspector-end-column":"17","trae-inspector-file-path":"src\\\\pages\\\\Home.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22E%3A%5C%5Ctrae%5C%5Ctrae%22%7D",onClick:E,disabled:r,className:"bg-kawaii-pink-500 text-white px-10 py-5 rounded-full text-2xl font-bold shadow-sticker hover:shadow-xl hover:scale-105 active:scale-95 transition-all transform flex items-center gap-4 mx-auto disabled:opacity-70 disabled:cursor-not-allowed font-cute border-4 border-white ring-4 ring-kawaii-pink-100",children:[t.jsx(f.div,{animate:r?{rotate:360}:{},transition:r?{repeat:1/0,duration:.3,ease:"linear"}:{},children:t.jsx(B,{className:"w-10 h-10"})}),r?"正在挑选...":"摇一摇"]})]})})};export{y as default};
